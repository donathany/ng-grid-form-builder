<div class="container">
  <div class="all-container">
  <div class="obs-container">
    <div class="col" style="height:100%">
      <form #form="ngForm"  class="ADD">

        <mat-grid-list [cols]=3 rowHeight="69px" >

          <mat-grid-tile [colspan]=1 fxLayout="row" [style.border]="bd ? '1px solid red' : 'none'" fxLayoutAlign="space-evenly stretch">

              <mat-form-field appearance="outline" style="width:50%">
                <mat-label>Row</mat-label>
                <input matInput type="number" name="rows" #rows="ngModel" [(ngModel)]="formService.t.rows" placeholder="LABEL">
              </mat-form-field>
              <mat-form-field appearance="outline" style="width:50%">
                <mat-label>Col</mat-label>
                <input matInput type="number" name="cols" #cols="ngModel" [(ngModel)]="formService.t.cols" placeholder="LABEL">
              </mat-form-field>

          </mat-grid-tile>
          <mat-grid-tile>
            <mat-form-field appearance="outline">
              <mat-label>Global Columns</mat-label>
              <input matInput type="number" name="columns" #ctrl="ngModel" [(ngModel)]="columns">
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile [colspan]=1>
            <button mat-raised-button (click)="addTile(form)" color="primary">ADD TILE</button>
            <button mat-raised-button (click)="removeTile()" color="warn">REMOVE TILE</button>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field appearance="outline">
              <mat-label>Form Name</mat-label>
              <input matInput  name="formName" #fmn="ngModel" [(ngModel)]="formName">
            </mat-form-field>
          </mat-grid-tile>
          <mat-grid-tile [rowspan]=1 [style.border]="'1px solid red'">
            <button mat-raised-button (click)="showBorder()">Show Borders</button>
          </mat-grid-tile>
          <mat-grid-tile>
            <button mat-raised-button (click)="showList(formName)">Download JSON</button>
          </mat-grid-tile>


        </mat-grid-list>
      </form>

    </div>


    <div class="example-box" cdkDrag fxLayout="column" style="position: absolute;">
      <div class="row" >

        <button mat-icon-button color="primary" (click)="arrayMove(selected, selected-1)"><mat-icon>arrow_back_ios</mat-icon></button>

        <h2  style="padding-top: 4px;"> Tile {{selected}} </h2>
        <button mat-icon-button color="primary" (click)="arrayMove(selected, selected+1)"><mat-icon>arrow_forward_ios</mat-icon></button>

      </div>

      <form #form="ngForm">
      <div *ngFor="let field of formService.blocklist[selected].fields; index as i" fxLayout="row" fxLayoutAlign="space-evenly">

        <mat-form-field  appearance="outline" style="width:45%">
          <mat-label>Label</mat-label>
          <input matInput name="{{field.label}}" #lbl="ngModel" [(ngModel)]="field.label" placeholder="{{field.label}}">
        </mat-form-field>
        <mat-form-field  appearance="outline" style="width:45%">
          <mat-label>Placeholder</mat-label>
          <input matInput name="{{field.placeholder}}" #pch="ngModel" [(ngModel)]="field.placeholder" placeholder="{{field.placeholder}}">
        </mat-form-field>
        <mat-form-field  appearance="outline" style="width:45%">
          <mat-label>Data</mat-label>
          <input matInput name="{{field.data}}" #{{}} #dta="ngModel" [(ngModel)]="field.data" placeholder="{{field.data}}">
        </mat-form-field>

      </div>
      </form>
    </div>


    <div style="height:'100px'"></div>

    <mat-grid-list [cols]=columns rowHeight="66.25px">

      <mat-grid-tile *ngFor="let tile of formService.blocklist;index as i" [rowspan]="tile.tile.rows" [colspan]="tile.tile.cols" [style.border]="bd ? '1px solid red' : 'none'" (click)="setSelected(i)" (dblclick)="deleteField(tile)">

        <div *ngIf="tile.tile.rows > tile.tile.cols; else rowBlock" fxLayout="column" fxLayoutAlign="space-evenly stretch" [ngStyle]="{width:'100%', height: '100%'}">

          <mat-form-field *ngFor="let field of tile.fields" appearance="outline">
            <mat-label>{{field.label}}</mat-label>
            <input matInput placeholder="{{field.placeholder}}">
          </mat-form-field>

          <div *ngIf="tile.fields.length < tile.tile.rows && tile.done == false">

            <form #form="ngForm" class="ADD">

              <mat-form-field appearance="outline">
                <mat-label>{{i}}</mat-label>
                <input matInput  name="label" #l="ngModel" [(ngModel)]="formService.b.label" placeholder="LABEL" required>
              </mat-form-field>
              <button type="button" mat-raised-button (click)="onSubmit(form, i); checkFull(tile, tile.tile.rows)"  color="primary" >ADD FIELD</button>
              <button type="button" mat-raised-button (click)="tile.done = true"  color="accent" >DONE</button>
              <button type="button" mat-raised-button (click)="deleteField(tile)"  color="warn" >DELETE FIELD</button>


            </form>
          </div>
        </div>

        <ng-template  #rowBlock>
          <div fxLayout="row" fxLayoutAlign="space-evenly stretch" [ngStyle]="{width:'100%'}">
          <mat-form-field *ngFor="let field of tile.fields" appearance="outline">
            <mat-label>{{field.label}}</mat-label>
            <input matInput placeholder="{{field.placeholder}}">
          </mat-form-field>

          <div *ngIf="tile.fields.length < tile.tile.cols && tile.done == false">

            <form #form="ngForm" class="ADD" style="background-color: violet; opacity: 80%;">

              <mat-form-field appearance="outline">
                <mat-label>{{i}}</mat-label>
                <input matInput  name="label" #l="ngModel" [(ngModel)]="formService.b.label" placeholder="LABEL" required>
              </mat-form-field>
              <button type="button" mat-raised-button (click)="onSubmit(form, i); checkFull(tile, tile.tile.cols)">ADD FIELD</button>
              <button type="button" mat-raised-button (click)="tile.done = true">DONE</button>
              <button type="button" mat-raised-button (click)="deleteField(tile)">DELETE FIELD</button>


            </form>
          </div>
          </div>

        </ng-template>



      </mat-grid-tile>



    </mat-grid-list>
  </div>
  </div>
  </div>
<app-form-reader></app-form-reader>
